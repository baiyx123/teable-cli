# Teable CLI 管道操作使用指南

## 快速入门

管道操作让 Teable CLI 支持 Linux 风格的命令链式处理。

### 基本语法
```
t show [条件] | Unix命令 | t update [字段=值]
```

## 常用命令

### 1. 查询和过滤
```bash
# 查看前10条记录
t show | head -10

# 统计记录数量
t show | wc -l

# 查找包含关键词的记录
t show | grep "张三"

# 排序显示
t show | sort
```

### 2. 批量插入
```bash
# 基于模板记录插入新记录
t show | head -1 | t insert 客户名称=新客户 客户编号=999

# 使用管道中的字段值
t show | head -1 | t insert 客户名称=客户名称 客户编号=客户编号

# 批量插入多条记录
t show 状态=待处理 | head -3 | t insert 状态=已复制 备注=来自模板
```

### 3. 批量更新
```bash
# 更新所有记录
t show | t update 状态=已处理

# 更新前5条记录
t show | head -5 | t update 优先级=高

# 条件更新
t show 客户类型=企业 | t update 等级=VIP
}

### 3. 复杂工作流
```bash
# 多步骤处理
t show 状态=新建 | head -20 | t update 处理人=张三

# 数据统计
t show | grep "信用等级=优秀" | wc -l

# 组合条件
t show 类型=企业 地区=上海 | head -10 | t update 标签=重点客户
```

## 工作原理

1. **流式查询**：一页一页查，不占用大量内存
2. **分批更新**：每10条记录一批，避免超时
3. **自动检测**：自动识别是否在管道模式中
4. **进度显示**：大量数据时显示处理进度

## 实际案例

### 案例1：客户分级
```bash
# 给信用好的客户升级
t show 信用等级=优秀 | t update 客户等级=金牌

# 只处理前100个
t show 信用等级=优秀 | head -100 | t update 标签=优质客户
```

### 案例2：数据清洗
```bash
# 批量修改状态
t show 状态=待审核 | t update 状态=审核中

# 按时间分批处理
t show 创建时间>2024-01-01 | head -50 | t update 标记=新客户
```

### 案例3：统计分析
```bash
# 统计各类客户数量
t show | grep "客户类型=企业" | wc -l
t show | grep "客户类型=个人" | wc -l

# 查看数据分布
t show | grep -o "信用等级=[^ ]*" | sort | uniq -c
```

## 性能特点

- **内存友好**：无论数据多大，内存占用都很小
- **速度快**：边查询边处理，不用等全部数据
- **稳定**：有错误处理，单个失败不影响整体
- **可中断**：随时可以 Ctrl+C 停止

## 注意事项

1. 管道命令会自动进入流式模式
2. 更新操作每10条一批，避免API限制
3. 大量数据（>1000条）会显示处理进度
4. 可以用 head/tail 控制处理数量

## 故障排除

**问题：更新很慢**
- 正常，因为要走API，每10条一批

**问题：管道断了**
- 检查是不是用了不兼容的命令
- 确保命令格式正确

**问题：数据没变化**
- 确认查询条件是否正确
- 检查是否有权限更新这些记录

记住：管道操作就是先把数据查出来，然后一条一条传给后面的命令处理！